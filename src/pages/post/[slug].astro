---
import Layout from "../../layouts/Layout.astro";
import { getPostInfo, getAllPostSlugs } from "../../lib/wp";

const slug = (Astro.params as { slug: string }).slug;
if (!slug) return Astro.redirect("/404");
const { title, content, date, excerpt } = await getPostInfo(slug);

export async function getStaticPaths() {
    const slugs = await getAllPostSlugs();
    return slugs.map((slug: string) => ({ params: { slug } }));
}
---

<Layout title={title}>
    <article class="dark:bg-slate-900 min-h-screen">
        <header class="mx-auto max-w-3xl px-4 pt-24 pb-16 lg:pt-32">
            <div class="space-y-6 text-center">
                <time 
                    class="inline-block text-sm font-medium text-orange-500 dark:text-orange-400 bg-orange-50 dark:bg-slate-800 px-4 py-1.5 rounded-full"
                >
                    {date}
                </time>
                <h1 class="mt-4 text-4xl font-bold text-gray-900 dark:text-white sm:text-5xl md:text-6xl leading-tight">
                    {title}
                </h1>
                <div 
                    class="mx-auto mt-6 max-w-2xl text-xl text-gray-600 dark:text-slate-400 [&>p]:leading-relaxed" 
                    set:html={excerpt}
                />
            </div>
        </header>

        <div class="relative mx-auto max-w-2xl px-4">
            <div class="absolute left-0 top-3 h-full w-0.5 bg-gray-100 dark:bg-slate-800" />
            
            <div 
                class="prose pt-1 ml-6 md:ml-0 dark:prose-invert prose-lg max-w-none pb-16 
                       prose-headings:font-semibold prose-a:text-orange-500
                       hover:prose-a:text-orange-600 dark:hover:prose-a:text-orange-400
                       prose-blockquote:border-l-orange-500 prose-blockquote:dark:text-slate-300
                       prose-pre:bg-slate-800 prose-pre:shadow-xl prose-pre:rounded-xl"
                set:html={content}
            />
            
            <div class="absolute left-4 md:left-0 top-3 h-4 w-4 md:-ml-1.5 bg-orange-500 rounded-full animate-pulse" />
        </div>

        <div class="mx-auto max-w-2xl px-4 pb-16">
            <a 
                href="/" 
                class="inline-flex items-center text-orange-500 dark:text-orange-400 hover:text-orange-600 dark:hover:text-orange-500 font-medium transition-colors"
            >
                <svg class="mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Volver
            </a>
        </div>
    </article>
</Layout>